<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Editor</title>
    <style>
        #editor {
            width: 100%;
            height: 300px;
            border: 1px solid #ccc;
            font-family: monospace;
            padding: 10px;
            white-space: pre-wrap;
            overflow-wrap: break-word;
            tab-size: 4;
        }
    </style>
</head>
<body>

<textarea id="editor" placeholder="Start typing in markdown..."></textarea>

<script>
    var editor = document.getElementById('editor')

    editor.addEventListener('keydown', function (e) {
        if (e.key === 'Tab' && !e.shiftKey) {
            e.preventDefault()
            var start = this.selectionStart
            var end = this.selectionEnd
            var before = this.value.substring(0, start)
            var after = this.value.substring(end)
            var lineStart = before.lastIndexOf('\n') + 1
            this.value = before.substring(0, lineStart) + '\t' + before.substring(lineStart) + after
            this.selectionStart = this.selectionEnd = start + 1
        } else if (e.key === 'Tab' && e.shiftKey) {
            e.preventDefault()
            var start = this.selectionStart
            var end = this.selectionEnd
            var before = this.value.substring(0, start)
            var after = this.value.substring(end)
            var lineStart = before.lastIndexOf('\n') + 1
            var currentLine = before.substring(lineStart)
            if (currentLine.startsWith('\t')) {
                this.value = before.substring(0, lineStart) + currentLine.substring(1) + after
                this.selectionStart = this.selectionEnd = start - 1
            }
        } else if (e.key === 'Enter') {
            var start = this.selectionStart
            var before = this.value.substring(0, start)
            var currentLine = before.substring(before.lastIndexOf('\n') + 1)
            var match = currentLine.match(/^(\s*- )/)
            if (match) {
                e.preventDefault()
                var spaces = match[1]
                var after = this.value.substring(start)
                this.value = before + '\n' + spaces + after
                this.selectionStart = this.selectionEnd = start + spaces.length + 1
            }
        }
    })
</script>

</body>
</html>
